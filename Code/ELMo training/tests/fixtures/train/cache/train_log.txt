Found 1 shards at /home/ubuntu/Downloads/elmo_train_bilm-tf-master/tests/fixtures/train/cache/sentences_new.txt
Loading data from: /home/ubuntu/Downloads/elmo_train_bilm-tf-master/tests/fixtures/train/cache/sentences_new.txt
Loaded 2246 sentences.
Finished loading
Found 1 shards at /home/ubuntu/Downloads/elmo_train_bilm-tf-master/tests/fixtures/train/cache/sentences_new.txt
Loading data from: /home/ubuntu/Downloads/elmo_train_bilm-tf-master/tests/fixtures/train/cache/sentences_new.txt
Loaded 2246 sentences.
Finished loading
1111111111111111111111 True
ccccccccccccccccccccccccccccccccccccccccc
char_Embedding---------------------------------------------------------------
USING SKIP CONNECTIONS
1111111111111111111111 True
ccccccccccccccccccccccccccccccccccccccccc
char_Embedding---------------------------------------------------------------
USING SKIP CONNECTIONS
1111111111111111111111 True
ccccccccccccccccccccccccccccccccccccccccc
char_Embedding---------------------------------------------------------------
USING SKIP CONNECTIONS
[['global_step:0', TensorShape([])],
 ['lm/CNN/W_cnn_0:0',
  TensorShape([Dimension(1), Dimension(1), Dimension(16), Dimension(32)])],
 ['lm/CNN/W_cnn_1:0',
  TensorShape([Dimension(1), Dimension(2), Dimension(16), Dimension(32)])],
 ['lm/CNN/W_cnn_2:0',
  TensorShape([Dimension(1), Dimension(3), Dimension(16), Dimension(64)])],
 ['lm/CNN/W_cnn_3:0',
  TensorShape([Dimension(1), Dimension(4), Dimension(16), Dimension(128)])],
 ['lm/CNN/W_cnn_4:0',
  TensorShape([Dimension(1), Dimension(5), Dimension(16), Dimension(256)])],
 ['lm/CNN/W_cnn_5:0',
  TensorShape([Dimension(1), Dimension(6), Dimension(16), Dimension(512)])],
 ['lm/CNN/W_cnn_6:0',
  TensorShape([Dimension(1), Dimension(7), Dimension(16), Dimension(1024)])],
 ['lm/CNN/b_cnn_0:0', TensorShape([Dimension(32)])],
 ['lm/CNN/b_cnn_1:0', TensorShape([Dimension(32)])],
 ['lm/CNN/b_cnn_2:0', TensorShape([Dimension(64)])],
 ['lm/CNN/b_cnn_3:0', TensorShape([Dimension(128)])],
 ['lm/CNN/b_cnn_4:0', TensorShape([Dimension(256)])],
 ['lm/CNN/b_cnn_5:0', TensorShape([Dimension(512)])],
 ['lm/CNN/b_cnn_6:0', TensorShape([Dimension(1024)])],
 ['lm/CNN_high_0/W_carry:0', TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_0/W_transform:0',
  TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_0/b_carry:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_high_0/b_transform:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_proj/W_proj:0', TensorShape([Dimension(2048), Dimension(128)])],
 ['lm/CNN_proj/b_proj:0', TensorShape([Dimension(128)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/bias:0',
  TensorShape([Dimension(4096)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/kernel:0',
  TensorShape([Dimension(256), Dimension(4096)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(1024), Dimension(128)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/bias:0',
  TensorShape([Dimension(4096)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/kernel:0',
  TensorShape([Dimension(256), Dimension(4096)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(1024), Dimension(128)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/bias:0',
  TensorShape([Dimension(4096)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/kernel:0',
  TensorShape([Dimension(256), Dimension(4096)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(1024), Dimension(128)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/bias:0',
  TensorShape([Dimension(4096)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/kernel:0',
  TensorShape([Dimension(256), Dimension(4096)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(1024), Dimension(128)])],
 ['lm/char_embed:0', TensorShape([Dimension(261), Dimension(16)])],
 ['lm/softmax/W:0', TensorShape([Dimension(8196), Dimension(128)])],
 ['lm/softmax/b:0', TensorShape([Dimension(8196)])],
 ['train_perplexity:0', TensorShape([])]]
Training for 10 epochs and 730 batches
Batch 100, train_perplexity=847.32153
Total time: 41.688133001327515
Batch 200, train_perplexity=227.79536
Total time: 66.19920825958252
Batch 300, train_perplexity=211.24977
Total time: 90.35054540634155
Batch 400, train_perplexity=225.17508
Total time: 114.61222982406616
Batch 500, train_perplexity=275.1901
Total time: 138.80590176582336
Batch 600, train_perplexity=98.55467
Total time: 162.96606636047363
Batch 700, train_perplexity=146.75385
Total time: 187.24926853179932
2021-02-22 14:24:04.739707 done training,saving vocab_embedding
<tf.Variable 'lm/char_embed:0' shape=(261, 16) dtype=float32_ref>
2021-02-22 14:24:05.731930 done vocab_embedding to vocab_embedding.hdf5
